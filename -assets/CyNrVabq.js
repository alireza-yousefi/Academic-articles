import{d as N,r as m,j as R,t as c,x as t,y as d,J as T,K as U,L as P,M as b,v as i,_ as V}from"./DKw33bMo.js";import{r as $,u as q}from"./BBN_n_R5.js";const G={class:"flex flex-col w-full p-5 Estedad_FD_Light",style:{direction:"rtl"}},J={class:"flex text-center justify-between mx-28 mt-10"},K={class:"text-center flex"},Q={key:0,class:"text-gray-600 mt-2"},z={key:1,class:"text-gray-600 mt-2"},H={class:"flex justify-center items-center"},W={class:"text-lg text-slate-800 font-bold w-full text-center Estedad_FD_Bold"},X={class:"text-sm text-slate-700 font-bold w-full text-center mt-3"},Y={class:"grid grid-cols-6 gap-5 w-full border-t border-slate-700 mt-2 py-2"},Z=N({__name:"index",setup(ee){const w=[{count:1,PersonOne:100,PersonOther:0},{count:2,PersonOne:90,PersonOther:60},{count:3,PersonOne:80,PersonOther:50},{count:4,PersonOne:70,PersonOther:40},{count:5,PersonOne:60,PersonOther:30},{count:6,PersonOne:50,PersonOther:25}],x=m([]),_=m(null),p=m(""),f=m(""),O=R(()=>{if(!f.value.trim())return x.value;const s=f.value.toLowerCase();return x.value.filter(e=>{var r;return((r=e.title)==null?void 0:r.toLowerCase().includes(s))||String(e.PriceAll).toLowerCase().includes(s)||String(e.ImpactFactor).toLowerCase().includes(s)||e.Authors.some(n=>{var o;return((o=n.name)==null?void 0:o.toLowerCase().includes(s))||String(n.price).toLowerCase().includes(s)||String(n.percent).toLowerCase().includes(s)})})}),A=()=>{f.value=p.value},C=()=>{p.value="",f.value=""},L=s=>{let e=(1.5*s+.25)*15e6*2;return Math.min(e,25e6)},S=(s,e,r)=>{let n=[...s];r.trim()==="مستخرج از پايان نامه دانشجوي هيات علمي"&&n.length>1&&n.shift();const o=Math.min(n.length,6),l=w.find(u=>u.count===o);return l?n.map((u,h)=>({name:u,percent:h===0?l.PersonOne:l.PersonOther,price:e*(h===0?l.PersonOne:l.PersonOther)/100})):[]},k=s=>{var n;const e=(n=s.target.files)==null?void 0:n[0];if(!e)return;_.value=e;const r=new FileReader;r.readAsArrayBuffer(e),r.onload=o=>{var g;const l=new Uint8Array((g=o.target)==null?void 0:g.result),u=$(l,{type:"array"}),h=u.SheetNames[0],D=u.Sheets[h],F=q.sheet_to_json(D,{header:1});x.value=F.filter(a=>a.length===22&&a[0]!=="DOI").map(a=>{const y=parseFloat(a[9]),j=(a[19]||"").split("*").map(M=>M.trim()),E=a[18],I=String(a[13]).trim(),v=L(y),B=S(j,v,I);return{title:E,ImpactFactor:y,PriceAll:v,Authors:B}})}};return(s,e)=>(i(),c("div",G,[t("div",J,[t("div",K,[e[1]||(e[1]=t("label",{for:"file-upload",class:"cursor-pointer bg-blue-500 text-white py-2 ml-4 px-4 rounded-lg hover:bg-blue-600 transition duration-300"}," فایل را انتخاب کنید ",-1)),t("input",{id:"file-upload",class:"hidden",type:"file",onChange:k,accept:".xlsx, .xls"},null,32),_.value?(i(),c("p",z,"فایل انتخاب شده: "+d(_.value.name),1)):(i(),c("p",Q,"هیچ فایلی انتخاب نشده است"))]),t("div",H,[T(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>p.value=r),type:"text",placeholder:"جستجو (مثلاً نام یا مبلغ)",class:"border rounded py-2 px-3 w-64"},null,512),[[U,p.value]]),t("button",{onClick:A,class:"bg-green-500 ml-1 text-white py-2 px-4 rounded-lg mr-2"},"جستجو"),t("button",{onClick:C,class:"bg-gray-500 text-white py-2 px-4 rounded-lg"},"حذف جستجو")])]),(i(!0),c(P,null,b(O.value,(r,n)=>(i(),c("div",{class:"my-2 bg-slate-200 flex flex-col justify-center items-center border border-slate-700 rounded-md p-2",key:`data_${n}`},[t("div",W,d(r.title),1),t("div",X,"مبلغ کل دریافتی : "+d(r.PriceAll.toLocaleString("fa-IR"))+" ریال",1),t("div",Y,[(i(!0),c(P,null,b(r.Authors,(o,l)=>(i(),c("div",{class:"my-2 bg-slate-200 flex flex-col justify-start items-center",key:`author${l}`},[t("span",null,d(o.name),1),t("span",null," درصد مشارکت : "+d(o.percent)+"% ",1),t("span",null," مبلغ : "+d(o.price.toLocaleString("fa-IR"))+" ریال",1)]))),128))])]))),128))]))}}),re=V(Z,[["__scopeId","data-v-8ad7a20c"]]);export{re as default};
